{% extends "base.html" %}
{% load bootstrap3 %}
{% load i18n %}
{% load cache %}

{% block extra_css %}
<style>
    .avatar {
        width:32px;
        height:32px;
    }
</style>
{% endblock %}

{% block content %}
{% if object_list %}
    {% cache 600 object_list %}
    {% for post in object_list %}
    <div itemprop="blogPost" itemscope itemtype="http://schema.org/Blog">
        <div class="col-md-offset-2">
            <ul>
                <div class="post-title"><h2><a href="{% url 'post' pk=post.pk slug=post.slug %}" rel="bookmark" itemprop="url"><span itemprop="headline">{{ post.title }}</span></a></h2></div>
                <ul>
                    <div class="post-time" itemprop="datePublished">{{ post.date_created }} от <img class="img-rounded avatar" src="{{ STATIC_URL }}{{ post.author.avatar }}"/> <span itemprop="author">{{ post.author }}</span></div>
                    <div class="post-content" itemprop="text">
                        {% autoescape off %}
                        {{ post.content | linebreaks | safe }}
                        {% endautoescape %}
                    </div>
                    <div class="post-content" itemscope itemtype="aggregateRating">
                        Рейтинг: {% if post.rating_set.count > 0 %}<span itemprop="ratingValue">{{ post.rating_set.count }}</span>{% else %}<span itemprop="ratingValue">0</span>{% endif %}
                        <a href="{% url 'rating_up' id=post.pk slug=post.slug %}">+</a>
                        <a href="{% url 'rating_down' id=post.pk slug=post.slug %}">-</a>
                    </div>
                    {% if post.author = user %}
                    <div class="post-content">
                        <a href="{% url 'edit_post' pk=post.pk %}">Редактирай</a>
                    </div>
                    {% endif %}
                </ul>
            </ul>
        </div>
        <br />
    </div>
    {% endfor %}
    {% endcache %}
    {% if is_paginated %}
        <div class="col-md-offset-6">
            {% bootstrap_pagination page_obj %}
        </div>
    {% endif %}

{% endif %}
{% endblock %}
